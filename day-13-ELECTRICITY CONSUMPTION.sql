/* 
	PROBLEM STATEMENT(6):
	ELECTRICITY CONSUMPTION
You have access to data from an electricity billing
system, detailing the electricity usage and cost for
specific households over billing periods in the years
2023 and 2024. Your objective is to present the total
electricity consumption, total cost and average
monthly consumption for each household per year
display the output in ascending order of each
household id & year of the bill.
*/
CREATE TABLE household_bills (
    BILL_ID INT PRIMARY KEY,
    HOUSEHOLD_ID INT,
    BILLING_PERIOD VARCHAR(7),
    CONSUMPTION_KWH DECIMAL(10, 2),
    TOTAL_COST DECIMAL(10, 2)
);
INSERT INTO household_bills (BILL_ID, HOUSEHOLD_ID, BILLING_PERIOD, CONSUMPTION_KWH, TOTAL_COST) VALUES
(1, 101, '2023-01', 320.5, 48.08),
(2, 101, '2023-02', 280, 42),
(3, 101, '2023-03', 310.5, 46.58),
(4, 101, '2023-04', 330.5, 49.58),
(5, 101, '2023-05', 310, 46.5),
(6, 101, '2023-06', 290.5, 43.58),
(7, 101, '2023-07', 320, 48),
(8, 101, '2023-08', 340.5, 51.08),
(9, 101, '2023-09', 300, 45),
(10, 101, '2023-10', 310.5, 46.58),
(11, 101, '2023-11', 320, 48),
(12, 101, '2023-12', 310.5, 46.58),
(13, 101, '2024-01', 320.5, 48.08),
(14, 101, '2024-02', 280, 42),
(15, 101, '2024-03', 310.5, 46.58),
(16, 101, '2024-04', 330.5, 49.58),
(17, 101, '2024-05', 310, 46.5),
(18, 101, '2024-06', 290.5, 43.58),
(19, 101, '2024-07', 320, 48),
(20, 101, '2024-08', 340.5, 51.08),
(21, 101, '2024-09', 300, 45),
(22, 101, '2024-10', 310.5, 46.58),
(23, 101, '2024-11', 320, 48),
(24, 101, '2024-12', 310.5, 46.58),
(25, 102, '2023-01', 450, 67.5),
(26, 102, '2023-02', 470, 70.5),
(27, 102, '2023-03', 480, 72),
(28, 102, '2023-04', 460, 69),
(29, 102, '2023-05', 480, 72),
(30, 102, '2023-06', 490, 73.5),
(31, 102, '2023-07', 500, 75),
(32, 102, '2023-08', 510, 76.5),
(33, 102, '2023-09', 520, 78),
(34, 102, '2023-10', 530, 79.5),
(35, 102, '2023-11', 540, 81),
(36, 102, '2023-12', 550, 82.5),
(37, 102, '2024-01', 560, 84),
(38, 102, '2024-02', 570, 85.5),
(39, 102, '2024-03', 580, 87),
(40, 102, '2024-04', 590, 88.5),
(41, 102, '2024-05', 600, 90),
(42, 102, '2024-06', 610, 91.5),
(43, 102, '2024-07', 620, 93),
(44, 102, '2024-08', 630, 94.5),
(45, 102, '2024-09', 640, 96),
(46, 102, '2024-10', 650, 97.5),
(47, 102, '2024-11', 660, 99),
(48, 102, '2024-12', 670, 100.5),
(49, 103, '2023-01', 510.7, 76.61),
(50, 103, '2023-02', 520.7, 78.11),
(51, 103, '2023-03', 530.7, 79.61),
(52, 103, '2023-04', 540.7, 81.11),
(53, 103, '2023-05', 550.7, 82.61),
(54, 103, '2023-06', 560.7, 84.11),
(55, 103, '2023-07', 570.7, 85.61),
(56, 103, '2023-08', 580.7, 87.11),
(57, 103, '2023-09', 590.7, 88.61),
(58, 103, '2023-10', 600.7, 90.11),
(59, 103, '2023-11', 610.7, 91.61),
(60, 103, '2023-12', 620.7, 93.11),
(61, 103, '2024-01', 630.7, 94.61),
(62, 103, '2024-02', 640.7, 96.11),
(63, 103, '2024-03', 650.7, 97.61),
(64, 103, '2024-04', 660.7, 99.11),
(65, 103, '2024-05', 670.7, 100.61),
(66, 103, '2024-06', 680.7, 102.11),
(67, 103, '2024-07', 690.7, 103.61),
(68, 103, '2024-08', 700.7, 105.11),
(69, 103, '2024-09', 710.7, 106.61),
(70, 103, '2024-10', 720.7, 108.11),
(71, 103, '2024-11', 730.7, 109.61),
(72, 103, '2024-12', 740.7, 111.11);


/*
EXPECTED OUTPUT:
------------------------------------------------------------------------------------
| HOUSEHOLD_ID | BILLING_YEAR | CONSUMPTION_KWH | TOTAL_COST | AVG_CONSUMPTION_KWH |
------------------------------------------------------------------------------------
|      101     |     2023     |      3743.5     |   561.56   |      311.96         |
|      101     |     2024     |      3743.5     |   561.56   |      311.96         |
|      102     |     2023     |      5980.0     |   897.00   |      498.33         |
|      102     |     2024     |      7380.0     |  1107.00   |      615.00         |
|      103     |     2023     |      6788.4     |  1018.32   |      565.70         |
|      103     |     2024     |      8228.4     |  1234.32   |      685.70         |
------------------------------------------------------------------------------------
*/
select * from household_bills;

select
household_id,
substr(billing_period,1,4) as billing_year,
sum(consumption_kwh) as CONSUMPTION_KWH,
sum(total_cost) as TOTAL_COST,
avg(consumption_kwh) as AVG_CONSUMPTION_KWH
from household_bills
group by household_id,substr(billing_period,1,4)

